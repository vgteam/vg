<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>vg: vg::PoissonSupportSnarlCaller Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">vg
   </div>
   <div id="projectbrief">tools for working with variation graphs</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespacevg.html">vg</a></li><li class="navelem"><a class="el" href="classvg_1_1PoissonSupportSnarlCaller.html">PoissonSupportSnarlCaller</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pro-methods">Protected Member Functions</a> &#124;
<a href="#pro-attribs">Protected Attributes</a> &#124;
<a href="classvg_1_1PoissonSupportSnarlCaller-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">vg::PoissonSupportSnarlCaller Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p><code>#include &lt;snarl_caller.hpp&gt;</code></p>
<div class="dynheader">
Inheritance diagram for vg::PoissonSupportSnarlCaller:</div>
<div class="dyncontent">
 <div class="center">
  <img src="classvg_1_1PoissonSupportSnarlCaller.png" usemap="#vg::PoissonSupportSnarlCaller_map" alt=""/>
  <map id="vg::PoissonSupportSnarlCaller_map" name="vg::PoissonSupportSnarlCaller_map">
<area href="classvg_1_1SupportBasedSnarlCaller.html" alt="vg::SupportBasedSnarlCaller" shape="rect" coords="0,56,184,80"/>
<area href="classvg_1_1SnarlCaller.html" alt="vg::SnarlCaller" shape="rect" coords="0,0,184,24"/>
  </map>
</div></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structvg_1_1PoissonSupportSnarlCaller_1_1PoissonCallInfo.html">PoissonCallInfo</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:aebde111c1431bf4af46929d8e56c7031"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classvg_1_1PoissonSupportSnarlCaller.html#aebde111c1431bf4af46929d8e56c7031">PoissonSupportSnarlCaller</a> (const <a class="el" href="classhandlegraph_1_1PathHandleGraph.html">PathHandleGraph</a> &amp;<a class="el" href="classvg_1_1SupportBasedSnarlCaller.html#ab0f5bd05d950be25e87a9f5fbc345a5c">graph</a>, <a class="el" href="classvg_1_1SnarlManager.html">SnarlManager</a> &amp;<a class="el" href="classvg_1_1SupportBasedSnarlCaller.html#a86c40f2d62950d1f484aa6dd84abf60d">snarl_manager</a>, <a class="el" href="classvg_1_1TraversalSupportFinder.html">TraversalSupportFinder</a> &amp;<a class="el" href="classvg_1_1SupportBasedSnarlCaller.html#a2af17a0bf619778576c49627563994dc">support_finder</a>, const <a class="el" href="namespacevg_1_1algorithms.html#acf8cb40a8f834b42f1ec89af0ef140b9">algorithms::BinnedDepthIndex</a> &amp;<a class="el" href="classvg_1_1PoissonSupportSnarlCaller.html#adebf4d923f033aa67032c4340d9ebb1e">depth_index</a>, bool <a class="el" href="classvg_1_1PoissonSupportSnarlCaller.html#a0588ea9ea69bf3c4c3f9108549e6102b">use_mapq</a>)</td></tr>
<tr class="separator:aebde111c1431bf4af46929d8e56c7031"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5bef85e69a8ae047888c4fb72356f215"><td class="memItemLeft" align="right" valign="top">virtual&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classvg_1_1PoissonSupportSnarlCaller.html#a5bef85e69a8ae047888c4fb72356f215">~PoissonSupportSnarlCaller</a> ()</td></tr>
<tr class="separator:a5bef85e69a8ae047888c4fb72356f215"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a41964acba3d81c26b01f9b00cd49257a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classvg_1_1PoissonSupportSnarlCaller.html#a41964acba3d81c26b01f9b00cd49257a">set_baseline_error</a> (double small_variant_error, double large_variant_error)</td></tr>
<tr class="memdesc:a41964acba3d81c26b01f9b00cd49257a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set some parameters.  <a href="classvg_1_1PoissonSupportSnarlCaller.html#a41964acba3d81c26b01f9b00cd49257a">More...</a><br /></td></tr>
<tr class="separator:a41964acba3d81c26b01f9b00cd49257a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abeb1d41aaa26a91cb3319cc5fe6b0af0"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classvg_1_1PoissonSupportSnarlCaller.html#abeb1d41aaa26a91cb3319cc5fe6b0af0">set_insertion_bias</a> (double <a class="el" href="classvg_1_1PoissonSupportSnarlCaller.html#a7787ef040764a33043fdbf3ba2f80509">insertion_threshold</a>, double small_insertion_bias, double large_insertion_bias)</td></tr>
<tr class="memdesc:abeb1d41aaa26a91cb3319cc5fe6b0af0"><td class="mdescLeft">&#160;</td><td class="mdescRight">These are multipliers applied to the errors if the site has an insertion.  <a href="classvg_1_1PoissonSupportSnarlCaller.html#abeb1d41aaa26a91cb3319cc5fe6b0af0">More...</a><br /></td></tr>
<tr class="separator:abeb1d41aaa26a91cb3319cc5fe6b0af0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1be3298970827475c5b96486d58fd833"><td class="memItemLeft" align="right" valign="top">virtual pair&lt; vector&lt; int &gt;, unique_ptr&lt; <a class="el" href="structvg_1_1SnarlCaller_1_1CallInfo.html">CallInfo</a> &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classvg_1_1PoissonSupportSnarlCaller.html#a1be3298970827475c5b96486d58fd833">genotype</a> (const <a class="el" href="structvg_1_1Snarl.html">Snarl</a> &amp;snarl, const vector&lt; <a class="el" href="structvg_1_1SnarlTraversal.html">SnarlTraversal</a> &gt; &amp;traversals, int ref_trav_idx, int ploidy, const string &amp;ref_path_name, pair&lt; size_t, size_t &gt; ref_range)</td></tr>
<tr class="memdesc:a1be3298970827475c5b96486d58fd833"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the genotype of a site.  <a href="classvg_1_1PoissonSupportSnarlCaller.html#a1be3298970827475c5b96486d58fd833">More...</a><br /></td></tr>
<tr class="separator:a1be3298970827475c5b96486d58fd833"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abe1990823417defcd0c6f68132680db1"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classvg_1_1PoissonSupportSnarlCaller.html#abe1990823417defcd0c6f68132680db1">update_vcf_info</a> (const <a class="el" href="structvg_1_1Snarl.html">Snarl</a> &amp;snarl, const vector&lt; <a class="el" href="structvg_1_1SnarlTraversal.html">SnarlTraversal</a> &gt; &amp;traversals, const vector&lt; int &gt; &amp;<a class="el" href="classvg_1_1PoissonSupportSnarlCaller.html#a1be3298970827475c5b96486d58fd833">genotype</a>, const unique_ptr&lt; <a class="el" href="structvg_1_1SnarlCaller_1_1CallInfo.html">CallInfo</a> &gt; &amp;call_info, const string &amp;sample_name, vcflib::Variant &amp;variant)</td></tr>
<tr class="memdesc:abe1990823417defcd0c6f68132680db1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Update INFO and FORMAT fields of the called variant.  <a href="classvg_1_1PoissonSupportSnarlCaller.html#abe1990823417defcd0c6f68132680db1">More...</a><br /></td></tr>
<tr class="separator:abe1990823417defcd0c6f68132680db1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2872f6728e288de01d5403fcdb76a05b"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classvg_1_1PoissonSupportSnarlCaller.html#a2872f6728e288de01d5403fcdb76a05b">update_vcf_header</a> (string &amp;header) const</td></tr>
<tr class="memdesc:a2872f6728e288de01d5403fcdb76a05b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Define any header fields needed by the above.  <a href="classvg_1_1PoissonSupportSnarlCaller.html#a2872f6728e288de01d5403fcdb76a05b">More...</a><br /></td></tr>
<tr class="separator:a2872f6728e288de01d5403fcdb76a05b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_methods_classvg_1_1SupportBasedSnarlCaller"><td colspan="2" onclick="javascript:toggleInherit('pub_methods_classvg_1_1SupportBasedSnarlCaller')"><img src="closed.png" alt="-"/>&#160;Public Member Functions inherited from <a class="el" href="classvg_1_1SupportBasedSnarlCaller.html">vg::SupportBasedSnarlCaller</a></td></tr>
<tr class="memitem:adff4e7045e950e7caea2858569afec02 inherit pub_methods_classvg_1_1SupportBasedSnarlCaller"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classvg_1_1SupportBasedSnarlCaller.html#adff4e7045e950e7caea2858569afec02">SupportBasedSnarlCaller</a> (const <a class="el" href="classhandlegraph_1_1PathHandleGraph.html">PathHandleGraph</a> &amp;<a class="el" href="classvg_1_1SupportBasedSnarlCaller.html#ab0f5bd05d950be25e87a9f5fbc345a5c">graph</a>, <a class="el" href="classvg_1_1SnarlManager.html">SnarlManager</a> &amp;<a class="el" href="classvg_1_1SupportBasedSnarlCaller.html#a86c40f2d62950d1f484aa6dd84abf60d">snarl_manager</a>, <a class="el" href="classvg_1_1TraversalSupportFinder.html">TraversalSupportFinder</a> &amp;<a class="el" href="classvg_1_1SupportBasedSnarlCaller.html#a2af17a0bf619778576c49627563994dc">support_finder</a>)</td></tr>
<tr class="separator:adff4e7045e950e7caea2858569afec02 inherit pub_methods_classvg_1_1SupportBasedSnarlCaller"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1bc8a2019ce7e220dbee5b26c4b27211 inherit pub_methods_classvg_1_1SupportBasedSnarlCaller"><td class="memItemLeft" align="right" valign="top">virtual&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classvg_1_1SupportBasedSnarlCaller.html#a1bc8a2019ce7e220dbee5b26c4b27211">~SupportBasedSnarlCaller</a> ()</td></tr>
<tr class="separator:a1bc8a2019ce7e220dbee5b26c4b27211 inherit pub_methods_classvg_1_1SupportBasedSnarlCaller"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3afbd8d1bc78b6716c587b93424db8cb inherit pub_methods_classvg_1_1SupportBasedSnarlCaller"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classvg_1_1SupportBasedSnarlCaller.html#a3afbd8d1bc78b6716c587b93424db8cb">set_min_supports</a> (double min_mad_for_call, double min_support_for_call, double min_site_support)</td></tr>
<tr class="memdesc:a3afbd8d1bc78b6716c587b93424db8cb inherit pub_methods_classvg_1_1SupportBasedSnarlCaller"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set some of the parameters.  <a href="classvg_1_1SupportBasedSnarlCaller.html#a3afbd8d1bc78b6716c587b93424db8cb">More...</a><br /></td></tr>
<tr class="separator:a3afbd8d1bc78b6716c587b93424db8cb inherit pub_methods_classvg_1_1SupportBasedSnarlCaller"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a04ebbd23ec0162a72c959351131e17ba inherit pub_methods_classvg_1_1SupportBasedSnarlCaller"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classvg_1_1TraversalSupportFinder.html">TraversalSupportFinder</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classvg_1_1SupportBasedSnarlCaller.html#a04ebbd23ec0162a72c959351131e17ba">get_support_finder</a> () const</td></tr>
<tr class="memdesc:a04ebbd23ec0162a72c959351131e17ba inherit pub_methods_classvg_1_1SupportBasedSnarlCaller"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the traversal support finder.  <a href="classvg_1_1SupportBasedSnarlCaller.html#a04ebbd23ec0162a72c959351131e17ba">More...</a><br /></td></tr>
<tr class="separator:a04ebbd23ec0162a72c959351131e17ba inherit pub_methods_classvg_1_1SupportBasedSnarlCaller"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac7e36771ace6cf84d9f4f732cdbc692f inherit pub_methods_classvg_1_1SupportBasedSnarlCaller"><td class="memItemLeft" align="right" valign="top">virtual int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classvg_1_1SupportBasedSnarlCaller.html#ac7e36771ace6cf84d9f4f732cdbc692f">get_min_total_support_for_call</a> () const</td></tr>
<tr class="memdesc:ac7e36771ace6cf84d9f4f732cdbc692f inherit pub_methods_classvg_1_1SupportBasedSnarlCaller"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the minimum total support for call.  <a href="classvg_1_1SupportBasedSnarlCaller.html#ac7e36771ace6cf84d9f4f732cdbc692f">More...</a><br /></td></tr>
<tr class="separator:ac7e36771ace6cf84d9f4f732cdbc692f inherit pub_methods_classvg_1_1SupportBasedSnarlCaller"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa702e223a90771c4090511c23b7c55a7 inherit pub_methods_classvg_1_1SupportBasedSnarlCaller"><td class="memItemLeft" align="right" valign="top">virtual function&lt; bool(const <a class="el" href="structvg_1_1SnarlTraversal.html">SnarlTraversal</a> &amp;, int iteration)&gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classvg_1_1SupportBasedSnarlCaller.html#aa702e223a90771c4090511c23b7c55a7">get_skip_allele_fn</a> () const</td></tr>
<tr class="memdesc:aa702e223a90771c4090511c23b7c55a7 inherit pub_methods_classvg_1_1SupportBasedSnarlCaller"><td class="mdescLeft">&#160;</td><td class="mdescRight">Use min_alt_path_support threshold as cutoff.  <a href="classvg_1_1SupportBasedSnarlCaller.html#aa702e223a90771c4090511c23b7c55a7">More...</a><br /></td></tr>
<tr class="separator:aa702e223a90771c4090511c23b7c55a7 inherit pub_methods_classvg_1_1SupportBasedSnarlCaller"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_methods_classvg_1_1SnarlCaller"><td colspan="2" onclick="javascript:toggleInherit('pub_methods_classvg_1_1SnarlCaller')"><img src="closed.png" alt="-"/>&#160;Public Member Functions inherited from <a class="el" href="classvg_1_1SnarlCaller.html">vg::SnarlCaller</a></td></tr>
<tr class="memitem:abda61a55c21f1473db0443293144c96d inherit pub_methods_classvg_1_1SnarlCaller"><td class="memItemLeft" align="right" valign="top">virtual&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classvg_1_1SnarlCaller.html#abda61a55c21f1473db0443293144c96d">~SnarlCaller</a> ()</td></tr>
<tr class="separator:abda61a55c21f1473db0443293144c96d inherit pub_methods_classvg_1_1SnarlCaller"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pro-methods"></a>
Protected Member Functions</h2></td></tr>
<tr class="memitem:a4a555a22f275a83ade8fcd35a1572908"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classvg_1_1PoissonSupportSnarlCaller.html#a4a555a22f275a83ade8fcd35a1572908">genotype_likelihood</a> (const vector&lt; int &gt; &amp;<a class="el" href="classvg_1_1PoissonSupportSnarlCaller.html#a1be3298970827475c5b96486d58fd833">genotype</a>, const vector&lt; <a class="el" href="structvg_1_1SnarlTraversal.html">SnarlTraversal</a> &gt; &amp;traversals, const set&lt; int &gt; &amp;trav_subset, const vector&lt; int &gt; &amp;traversal_sizes, const vector&lt; double &gt; &amp;traversal_mapqs, int ref_trav_idx, double exp_depth, double depth_err, int max_trav_size, int ref_trav_size)</td></tr>
<tr class="separator:a4a555a22f275a83ade8fcd35a1572908"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a300ca3bbff527fb43fbc12e65177d053"><td class="memItemLeft" align="right" valign="top">vector&lt; int &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classvg_1_1PoissonSupportSnarlCaller.html#a300ca3bbff527fb43fbc12e65177d053">rank_by_support</a> (const vector&lt; <a class="el" href="structvg_1_1Support.html">Support</a> &gt; &amp;supports)</td></tr>
<tr class="memdesc:a300ca3bbff527fb43fbc12e65177d053"><td class="mdescLeft">&#160;</td><td class="mdescRight">Rank supports.  <a href="classvg_1_1PoissonSupportSnarlCaller.html#a300ca3bbff527fb43fbc12e65177d053">More...</a><br /></td></tr>
<tr class="separator:a300ca3bbff527fb43fbc12e65177d053"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pro-attribs"></a>
Protected Attributes</h2></td></tr>
<tr class="memitem:a68e6d4d6785bdb4eca4f57504b7dcd21"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classvg_1_1PoissonSupportSnarlCaller.html#a68e6d4d6785bdb4eca4f57504b7dcd21">baseline_error_small</a> = 0.005</td></tr>
<tr class="memdesc:a68e6d4d6785bdb4eca4f57504b7dcd21"><td class="mdescLeft">&#160;</td><td class="mdescRight">Baseline error rate for smaller variants.  <a href="classvg_1_1PoissonSupportSnarlCaller.html#a68e6d4d6785bdb4eca4f57504b7dcd21">More...</a><br /></td></tr>
<tr class="separator:a68e6d4d6785bdb4eca4f57504b7dcd21"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9164191ad441f1323f4b6cd406bc4030"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classvg_1_1PoissonSupportSnarlCaller.html#a9164191ad441f1323f4b6cd406bc4030">baseline_error_large</a> = 0.01</td></tr>
<tr class="memdesc:a9164191ad441f1323f4b6cd406bc4030"><td class="mdescLeft">&#160;</td><td class="mdescRight">Baseline error rate for larger variants.  <a href="classvg_1_1PoissonSupportSnarlCaller.html#a9164191ad441f1323f4b6cd406bc4030">More...</a><br /></td></tr>
<tr class="separator:a9164191ad441f1323f4b6cd406bc4030"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a82d1c5780e74107618f3e50d7085f38e"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classvg_1_1PoissonSupportSnarlCaller.html#a82d1c5780e74107618f3e50d7085f38e">insertion_bias_large</a> = 1.</td></tr>
<tr class="separator:a82d1c5780e74107618f3e50d7085f38e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4a5120550fa398555a1a414717469664"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classvg_1_1PoissonSupportSnarlCaller.html#a4a5120550fa398555a1a414717469664">insertion_bias_small</a> = 1.</td></tr>
<tr class="separator:a4a5120550fa398555a1a414717469664"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7787ef040764a33043fdbf3ba2f80509"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classvg_1_1PoissonSupportSnarlCaller.html#a7787ef040764a33043fdbf3ba2f80509">insertion_threshold</a> = 5.</td></tr>
<tr class="separator:a7787ef040764a33043fdbf3ba2f80509"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4610e26e36319f7b2620566c7b655c63"><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classvg_1_1PoissonSupportSnarlCaller.html#a4610e26e36319f7b2620566c7b655c63">top_k</a> = 20</td></tr>
<tr class="memdesc:a4610e26e36319f7b2620566c7b655c63"><td class="mdescLeft">&#160;</td><td class="mdescRight">Consider up to the top-k traversals (based on support) for genotyping.  <a href="classvg_1_1PoissonSupportSnarlCaller.html#a4610e26e36319f7b2620566c7b655c63">More...</a><br /></td></tr>
<tr class="separator:a4610e26e36319f7b2620566c7b655c63"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af61d6e6931ba127537e41cfdbf258d38"><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classvg_1_1PoissonSupportSnarlCaller.html#af61d6e6931ba127537e41cfdbf258d38">top_m</a> = 100</td></tr>
<tr class="separator:af61d6e6931ba127537e41cfdbf258d38"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a53eec737bc91a46f91161c18ddc26cd7"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classvg_1_1PoissonSupportSnarlCaller.html#a53eec737bc91a46f91161c18ddc26cd7">depth_padding_factor</a> = 1.</td></tr>
<tr class="memdesc:a53eec737bc91a46f91161c18ddc26cd7"><td class="mdescLeft">&#160;</td><td class="mdescRight">padding to apply wrt to longest traversal to snarl ranges when looking up binned depth  <a href="classvg_1_1PoissonSupportSnarlCaller.html#a53eec737bc91a46f91161c18ddc26cd7">More...</a><br /></td></tr>
<tr class="separator:a53eec737bc91a46f91161c18ddc26cd7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adebf4d923f033aa67032c4340d9ebb1e"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="namespacevg_1_1algorithms.html#acf8cb40a8f834b42f1ec89af0ef140b9">algorithms::BinnedDepthIndex</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classvg_1_1PoissonSupportSnarlCaller.html#adebf4d923f033aa67032c4340d9ebb1e">depth_index</a></td></tr>
<tr class="memdesc:adebf4d923f033aa67032c4340d9ebb1e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Map path name to &lt;mean, std_err&gt; of depth coverage from the packer.  <a href="classvg_1_1PoissonSupportSnarlCaller.html#adebf4d923f033aa67032c4340d9ebb1e">More...</a><br /></td></tr>
<tr class="separator:adebf4d923f033aa67032c4340d9ebb1e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0588ea9ea69bf3c4c3f9108549e6102b"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classvg_1_1PoissonSupportSnarlCaller.html#a0588ea9ea69bf3c4c3f9108549e6102b">use_mapq</a></td></tr>
<tr class="memdesc:a0588ea9ea69bf3c4c3f9108549e6102b"><td class="mdescLeft">&#160;</td><td class="mdescRight">MAPQ information is available from the packer and we want to use it.  <a href="classvg_1_1PoissonSupportSnarlCaller.html#a0588ea9ea69bf3c4c3f9108549e6102b">More...</a><br /></td></tr>
<tr class="separator:a0588ea9ea69bf3c4c3f9108549e6102b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pro_attribs_classvg_1_1SupportBasedSnarlCaller"><td colspan="2" onclick="javascript:toggleInherit('pro_attribs_classvg_1_1SupportBasedSnarlCaller')"><img src="closed.png" alt="-"/>&#160;Protected Attributes inherited from <a class="el" href="classvg_1_1SupportBasedSnarlCaller.html">vg::SupportBasedSnarlCaller</a></td></tr>
<tr class="memitem:ab0f5bd05d950be25e87a9f5fbc345a5c inherit pro_attribs_classvg_1_1SupportBasedSnarlCaller"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="classhandlegraph_1_1PathHandleGraph.html">PathHandleGraph</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classvg_1_1SupportBasedSnarlCaller.html#ab0f5bd05d950be25e87a9f5fbc345a5c">graph</a></td></tr>
<tr class="separator:ab0f5bd05d950be25e87a9f5fbc345a5c inherit pro_attribs_classvg_1_1SupportBasedSnarlCaller"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a86c40f2d62950d1f484aa6dd84abf60d inherit pro_attribs_classvg_1_1SupportBasedSnarlCaller"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classvg_1_1SnarlManager.html">SnarlManager</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classvg_1_1SupportBasedSnarlCaller.html#a86c40f2d62950d1f484aa6dd84abf60d">snarl_manager</a></td></tr>
<tr class="separator:a86c40f2d62950d1f484aa6dd84abf60d inherit pro_attribs_classvg_1_1SupportBasedSnarlCaller"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2af17a0bf619778576c49627563994dc inherit pro_attribs_classvg_1_1SupportBasedSnarlCaller"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classvg_1_1TraversalSupportFinder.html">TraversalSupportFinder</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classvg_1_1SupportBasedSnarlCaller.html#a2af17a0bf619778576c49627563994dc">support_finder</a></td></tr>
<tr class="memdesc:a2af17a0bf619778576c49627563994dc inherit pro_attribs_classvg_1_1SupportBasedSnarlCaller"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get support from traversals.  <a href="classvg_1_1SupportBasedSnarlCaller.html#a2af17a0bf619778576c49627563994dc">More...</a><br /></td></tr>
<tr class="separator:a2af17a0bf619778576c49627563994dc inherit pro_attribs_classvg_1_1SupportBasedSnarlCaller"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a559c8afa8e4f1f73768d7d90ff6a6db0 inherit pro_attribs_classvg_1_1SupportBasedSnarlCaller"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classvg_1_1SupportBasedSnarlCaller.html#a559c8afa8e4f1f73768d7d90ff6a6db0">min_total_support_for_call</a> = 2</td></tr>
<tr class="separator:a559c8afa8e4f1f73768d7d90ff6a6db0 inherit pro_attribs_classvg_1_1SupportBasedSnarlCaller"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aec268641676f41d2c24128cb9e17ac03 inherit pro_attribs_classvg_1_1SupportBasedSnarlCaller"><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classvg_1_1SupportBasedSnarlCaller.html#aec268641676f41d2c24128cb9e17ac03">min_mad_for_filter</a> = 1</td></tr>
<tr class="separator:aec268641676f41d2c24128cb9e17ac03 inherit pro_attribs_classvg_1_1SupportBasedSnarlCaller"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adde07f3e5ca89a2a565e8859ee641159 inherit pro_attribs_classvg_1_1SupportBasedSnarlCaller"><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classvg_1_1SupportBasedSnarlCaller.html#adde07f3e5ca89a2a565e8859ee641159">min_site_depth</a> = 4</td></tr>
<tr class="separator:adde07f3e5ca89a2a565e8859ee641159 inherit pro_attribs_classvg_1_1SupportBasedSnarlCaller"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a17f76956318b838695d8b120d553ce24 inherit pro_attribs_classvg_1_1SupportBasedSnarlCaller"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classvg_1_1SupportBasedSnarlCaller.html#a17f76956318b838695d8b120d553ce24">min_alt_path_support</a> = 0.5</td></tr>
<tr class="separator:a17f76956318b838695d8b120d553ce24 inherit pro_attribs_classvg_1_1SupportBasedSnarlCaller"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="inherited"></a>
Additional Inherited Members</h2></td></tr>
<tr class="inherit_header pro_static_methods_classvg_1_1SupportBasedSnarlCaller"><td colspan="2" onclick="javascript:toggleInherit('pro_static_methods_classvg_1_1SupportBasedSnarlCaller')"><img src="closed.png" alt="-"/>&#160;Static Protected Member Functions inherited from <a class="el" href="classvg_1_1SupportBasedSnarlCaller.html">vg::SupportBasedSnarlCaller</a></td></tr>
<tr class="memitem:a1b5a50373729771229ada685b12627df inherit pro_static_methods_classvg_1_1SupportBasedSnarlCaller"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classvg_1_1SupportBasedSnarlCaller.html#a1b5a50373729771229ada685b12627df">get_best_support</a> (const vector&lt; <a class="el" href="structvg_1_1Support.html">Support</a> &gt; &amp;supports, const vector&lt; int &gt; &amp;skips)</td></tr>
<tr class="memdesc:a1b5a50373729771229ada685b12627df inherit pro_static_methods_classvg_1_1SupportBasedSnarlCaller"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the best support out of a list of supports, ignoring skips.  <a href="classvg_1_1SupportBasedSnarlCaller.html#a1b5a50373729771229ada685b12627df">More...</a><br /></td></tr>
<tr class="separator:a1b5a50373729771229ada685b12627df inherit pro_static_methods_classvg_1_1SupportBasedSnarlCaller"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a84da98787b002a2ed9c8c1da6661cebd inherit pro_static_methods_classvg_1_1SupportBasedSnarlCaller"><td class="memItemLeft" align="right" valign="top">static double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classvg_1_1SupportBasedSnarlCaller.html#a84da98787b002a2ed9c8c1da6661cebd">support_val</a> (const <a class="el" href="structvg_1_1Support.html">Support</a> &amp;support)</td></tr>
<tr class="memdesc:a84da98787b002a2ed9c8c1da6661cebd inherit pro_static_methods_classvg_1_1SupportBasedSnarlCaller"><td class="mdescLeft">&#160;</td><td class="mdescRight">Relic from old code.  <a href="classvg_1_1SupportBasedSnarlCaller.html#a84da98787b002a2ed9c8c1da6661cebd">More...</a><br /></td></tr>
<tr class="separator:a84da98787b002a2ed9c8c1da6661cebd inherit pro_static_methods_classvg_1_1SupportBasedSnarlCaller"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Find the genotype of some traversals in a site using read support and a Poisson model based on expected depth. Inspired, in part, by Paragraph, which uses a similar approach for genotyping break points </p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="aebde111c1431bf4af46929d8e56c7031"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aebde111c1431bf4af46929d8e56c7031">&#9670;&nbsp;</a></span>PoissonSupportSnarlCaller()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">vg::PoissonSupportSnarlCaller::PoissonSupportSnarlCaller </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classhandlegraph_1_1PathHandleGraph.html">PathHandleGraph</a> &amp;&#160;</td>
          <td class="paramname"><em>graph</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classvg_1_1SnarlManager.html">SnarlManager</a> &amp;&#160;</td>
          <td class="paramname"><em>snarl_manager</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classvg_1_1TraversalSupportFinder.html">TraversalSupportFinder</a> &amp;&#160;</td>
          <td class="paramname"><em>support_finder</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="namespacevg_1_1algorithms.html#acf8cb40a8f834b42f1ec89af0ef140b9">algorithms::BinnedDepthIndex</a> &amp;&#160;</td>
          <td class="paramname"><em>depth_index</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>use_mapq</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a5bef85e69a8ae047888c4fb72356f215"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5bef85e69a8ae047888c4fb72356f215">&#9670;&nbsp;</a></span>~PoissonSupportSnarlCaller()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">vg::PoissonSupportSnarlCaller::~PoissonSupportSnarlCaller </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a1be3298970827475c5b96486d58fd833"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1be3298970827475c5b96486d58fd833">&#9670;&nbsp;</a></span>genotype()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">pair&lt; vector&lt; int &gt;, unique_ptr&lt; <a class="el" href="structvg_1_1SnarlCaller_1_1CallInfo.html">SnarlCaller::CallInfo</a> &gt; &gt; vg::PoissonSupportSnarlCaller::genotype </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structvg_1_1Snarl.html">Snarl</a> &amp;&#160;</td>
          <td class="paramname"><em>snarl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const vector&lt; <a class="el" href="structvg_1_1SnarlTraversal.html">SnarlTraversal</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>traversals</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ref_trav_idx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ploidy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const string &amp;&#160;</td>
          <td class="paramname"><em>ref_path_name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">pair&lt; size_t, size_t &gt;&#160;</td>
          <td class="paramname"><em>ref_range</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get the genotype of a site. </p>

<p>Implements <a class="el" href="classvg_1_1SnarlCaller.html#a3e4d1ad4ece1a1bc1daa4ea6ecfbfa54">vg::SnarlCaller</a>.</p>

</div>
</div>
<a id="a4a555a22f275a83ade8fcd35a1572908"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4a555a22f275a83ade8fcd35a1572908">&#9670;&nbsp;</a></span>genotype_likelihood()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double vg::PoissonSupportSnarlCaller::genotype_likelihood </td>
          <td>(</td>
          <td class="paramtype">const vector&lt; int &gt; &amp;&#160;</td>
          <td class="paramname"><em>genotype</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const vector&lt; <a class="el" href="structvg_1_1SnarlTraversal.html">SnarlTraversal</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>traversals</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const set&lt; int &gt; &amp;&#160;</td>
          <td class="paramname"><em>trav_subset</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const vector&lt; int &gt; &amp;&#160;</td>
          <td class="paramname"><em>traversal_sizes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const vector&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>traversal_mapqs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ref_trav_idx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>exp_depth</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>depth_err</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>max_trav_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ref_trav_size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Compute likelihood of genotype as product of poisson probabilities P[allele1] * P[allle2] * P[uncalled alleles] Homozygous alleles are split into two, with half support each The (natural) logoarithm is returned If trav_subset is not empty, traversals outside that set (and genotype) will be ignored to save time </p>

</div>
</div>
<a id="a300ca3bbff527fb43fbc12e65177d053"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a300ca3bbff527fb43fbc12e65177d053">&#9670;&nbsp;</a></span>rank_by_support()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">vector&lt; int &gt; vg::PoissonSupportSnarlCaller::rank_by_support </td>
          <td>(</td>
          <td class="paramtype">const vector&lt; <a class="el" href="structvg_1_1Support.html">Support</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>supports</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Rank supports. </p>

</div>
</div>
<a id="a41964acba3d81c26b01f9b00cd49257a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a41964acba3d81c26b01f9b00cd49257a">&#9670;&nbsp;</a></span>set_baseline_error()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void vg::PoissonSupportSnarlCaller::set_baseline_error </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>small_variant_error</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>large_variant_error</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set some parameters. </p>

</div>
</div>
<a id="abeb1d41aaa26a91cb3319cc5fe6b0af0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abeb1d41aaa26a91cb3319cc5fe6b0af0">&#9670;&nbsp;</a></span>set_insertion_bias()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void vg::PoissonSupportSnarlCaller::set_insertion_bias </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>insertion_threshold</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>small_insertion_bias</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>large_insertion_bias</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>These are multipliers applied to the errors if the site has an insertion. </p>

</div>
</div>
<a id="a2872f6728e288de01d5403fcdb76a05b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2872f6728e288de01d5403fcdb76a05b">&#9670;&nbsp;</a></span>update_vcf_header()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void vg::PoissonSupportSnarlCaller::update_vcf_header </td>
          <td>(</td>
          <td class="paramtype">string &amp;&#160;</td>
          <td class="paramname"><em>header</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Define any header fields needed by the above. </p>

<p>Implements <a class="el" href="classvg_1_1SnarlCaller.html#a7fb3205d6e94505aadf0c9944fac7eb4">vg::SnarlCaller</a>.</p>

</div>
</div>
<a id="abe1990823417defcd0c6f68132680db1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abe1990823417defcd0c6f68132680db1">&#9670;&nbsp;</a></span>update_vcf_info()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void vg::PoissonSupportSnarlCaller::update_vcf_info </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structvg_1_1Snarl.html">Snarl</a> &amp;&#160;</td>
          <td class="paramname"><em>snarl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const vector&lt; <a class="el" href="structvg_1_1SnarlTraversal.html">SnarlTraversal</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>traversals</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const vector&lt; int &gt; &amp;&#160;</td>
          <td class="paramname"><em>genotype</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unique_ptr&lt; <a class="el" href="structvg_1_1SnarlCaller_1_1CallInfo.html">CallInfo</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>call_info</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const string &amp;&#160;</td>
          <td class="paramname"><em>sample_name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">vcflib::Variant &amp;&#160;</td>
          <td class="paramname"><em>variant</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Update INFO and FORMAT fields of the called variant. </p>

<p>Reimplemented from <a class="el" href="classvg_1_1SupportBasedSnarlCaller.html#a3ddd1e17537734b984fa0befe9f0d7f6">vg::SupportBasedSnarlCaller</a>.</p>

</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="a9164191ad441f1323f4b6cd406bc4030"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9164191ad441f1323f4b6cd406bc4030">&#9670;&nbsp;</a></span>baseline_error_large</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double vg::PoissonSupportSnarlCaller::baseline_error_large = 0.01</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Baseline error rate for larger variants. </p>

</div>
</div>
<a id="a68e6d4d6785bdb4eca4f57504b7dcd21"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a68e6d4d6785bdb4eca4f57504b7dcd21">&#9670;&nbsp;</a></span>baseline_error_small</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double vg::PoissonSupportSnarlCaller::baseline_error_small = 0.005</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Baseline error rate for smaller variants. </p>
<p>Error rates are different for small and large variants, which depend more on base and mapping qualities respectively. The switch threshold is in <a class="el" href="classvg_1_1TraversalSupportFinder.html">TraversalSupportFinder</a>. Error stats from the <a class="el" href="classvg_1_1Packer.html">Packer</a> object get added to these baselines when computing the scores. <br  />
 </p>

</div>
</div>
<a id="adebf4d923f033aa67032c4340d9ebb1e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adebf4d923f033aa67032c4340d9ebb1e">&#9670;&nbsp;</a></span>depth_index</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="namespacevg_1_1algorithms.html#acf8cb40a8f834b42f1ec89af0ef140b9">algorithms::BinnedDepthIndex</a>&amp; vg::PoissonSupportSnarlCaller::depth_index</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Map path name to &lt;mean, std_err&gt; of depth coverage from the packer. </p>

</div>
</div>
<a id="a53eec737bc91a46f91161c18ddc26cd7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a53eec737bc91a46f91161c18ddc26cd7">&#9670;&nbsp;</a></span>depth_padding_factor</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double vg::PoissonSupportSnarlCaller::depth_padding_factor = 1.</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>padding to apply wrt to longest traversal to snarl ranges when looking up binned depth </p>

</div>
</div>
<a id="a82d1c5780e74107618f3e50d7085f38e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a82d1c5780e74107618f3e50d7085f38e">&#9670;&nbsp;</a></span>insertion_bias_large</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double vg::PoissonSupportSnarlCaller::insertion_bias_large = 1.</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>multiply error by this much in pressence of insertion (after some testing, this does not in fact seem to help much in practice. best just to boost overall error above. hence not in CLI and off by default) </p>

</div>
</div>
<a id="a4a5120550fa398555a1a414717469664"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4a5120550fa398555a1a414717469664">&#9670;&nbsp;</a></span>insertion_bias_small</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double vg::PoissonSupportSnarlCaller::insertion_bias_small = 1.</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<a id="a7787ef040764a33043fdbf3ba2f80509"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7787ef040764a33043fdbf3ba2f80509">&#9670;&nbsp;</a></span>insertion_threshold</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double vg::PoissonSupportSnarlCaller::insertion_threshold = 5.</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>a site is an insertion if one (supported)allele is this many times bigger than another unlike above, default comes from <a class="el" href="call__main_8cpp.html">call_main.cpp</a> (todo: straighten this out?) </p>

</div>
</div>
<a id="a4610e26e36319f7b2620566c7b655c63"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4610e26e36319f7b2620566c7b655c63">&#9670;&nbsp;</a></span>top_k</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">size_t vg::PoissonSupportSnarlCaller::top_k = 20</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Consider up to the top-k traversals (based on support) for genotyping. </p>

</div>
</div>
<a id="af61d6e6931ba127537e41cfdbf258d38"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af61d6e6931ba127537e41cfdbf258d38">&#9670;&nbsp;</a></span>top_m</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">size_t vg::PoissonSupportSnarlCaller::top_m = 100</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Consider up to the tom-m secondary traversals (based on support) for each top traversal (so at most top_k * top_m considered) </p>

</div>
</div>
<a id="a0588ea9ea69bf3c4c3f9108549e6102b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0588ea9ea69bf3c4c3f9108549e6102b">&#9670;&nbsp;</a></span>use_mapq</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool vg::PoissonSupportSnarlCaller::use_mapq</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>MAPQ information is available from the packer and we want to use it. </p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>src/<a class="el" href="snarl__caller_8hpp.html">snarl_caller.hpp</a></li>
<li>src/<a class="el" href="snarl__caller_8cpp.html">snarl_caller.cpp</a></li>
</ul>
</div><!-- contents -->
<!-- HTML footer for doxygen 1.8.9.1-->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.17
</small></address>
</body>
</html>
